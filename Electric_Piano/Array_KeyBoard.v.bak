module Array_KeyBoard(
    input clk,
    input rst_n,
    input [3:0] row,
    output reg [3:0] col,
    output reg [15:0] key_out
);

// 状态机和扫描逻辑（简化为轮询扫描）
reg [1:0] scan_cnt;
always @(posedge clk or negedge rst_n) begin
    if (!rst_n) begin
        scan_cnt <= 0;
        col <= 4'b1111;
    end else begin
        scan_cnt <= scan_cnt + 1;
        case (scan_cnt)
            2'b00: col <= 4'b1110;
            2'b01: col <= 4'b1101;
            2'b10: col <= 4'b1011;
            2'b11: col <= 4'b0111;
        endcase
    end
end

// 检测行输入并生成key_out
always @(posedge clk or negedge rst_n) begin
    if (!rst_n) begin
        key_out <= 16'h0000;
    end else begin
        case (col)
            4'b1110: key_out[3:0]   <= ~row;
            4'b1101: key_out[7:4]   <= ~row;
            4'b1011: key_out[11:8]  <= ~row;
            4'b0111: key_out[15:12] <= ~row;
            default: key_out <= 16'h0000;
        endcase
    end
end

endmodule
# 高级电子琴项目说明文档
## Advanced Electric Piano Project

### 项目概述
这是一个基于FPGA的高级电子琴系统，支持手动演奏和自动播放多首周杰伦经典歌曲。

### 功能特性
1. **手动演奏模式**：使用4x4矩阵键盘进行实时演奏
2. **自动播放模式**：支持以下歌曲的自动播放
   - 《稻香》- 周杰伦代表作，温馨治愈的旋律
   - 《青花瓷》- 中国风经典，优美的词曲搭配
   - 《告白气球》- 浪漫情歌，轻快甜蜜的旋律
   - 《简单爱》- 简约风格，朗朗上口的旋律

### 硬件接口
#### 输入接口
- **clk**: 系统时钟输入 (12MHz)
- **rst_n**: 复位信号 (低电平有效)
- **col[3:0]**: 矩阵键盘列输入

#### 输出接口
- **row[3:0]**: 矩阵键盘行输出
- **beeper**: 蜂鸣器音频输出
- **led_display[7:0]**: LED模式显示
- **mode_indicator[3:0]**: 模式指示灯

### 操作指南
#### 模式切换
使用矩阵键盘的特定按键进行模式切换：
- **按键16 (右上角)**: 切换到手动演奏模式
- **按键15**: 播放《稻香》
- **按键14**: 播放《青花瓷》
- **按键13**: 播放《告白气球》
- **按键12**: 播放《简单爱》

#### 手动演奏
在手动模式下，16个按键对应不同的音符：
```
按键布局 (从左到右，从上到下):
Row 1: C4(Do)  D4(Re)  E4(Mi)  F4(Fa)
Row 2: G4(So)  A4(La)  B4(Si)  C5(Do高)
Row 3: D5(Re高) E5(Mi高) F5(Fa高) G5(So高)
Row 4: A5(La高) B5(Si高) C6(Do超高) [模式切换]
```

#### LED指示说明
- **led_display**: 8位LED显示当前工作模式
  - 0x01: 手动演奏模式
  - 0x02: 稻香播放模式
  - 0x04: 青花瓷播放模式
  - 0x08: 告白气球播放模式
  - 0x10: 简单爱播放模式

- **mode_indicator**: 4位模式指示灯
  - 单个LED亮起表示对应模式
  - 全亮表示第5个模式（简单爱）

### 技术实现
#### 系统架构
```
Advanced_Electric_Piano (顶层模块)
├── Array_KeyBoard (矩阵键盘驱动)
├── Mode_Controller (模式控制器)
├── Music_Player (音乐播放器)
└── Advanced_Beeper (高级蜂鸣器)
    ├── Advanced_Tone (音调转换)
    └── PWM (PWM信号生成)
```

#### 音乐播放原理
1. **音符编码**: 每个音符对应特定的PWM周期值
2. **节拍控制**: 使用计数器生成2Hz节拍信号
3. **旋律存储**: 将歌曲旋律存储为音符序列数组
4. **循环播放**: 歌曲播放完毕后自动重新开始

#### 歌曲简谱说明
##### 《稻香》主旋律片段
```
So La Do(高) La | So Fa Mi Re | Do _ _ _ |
Mi Fa So La | So Fa Mi Re | Do _ _ _ |
Do(高) Si La So | Fa Mi Re Mi | Do _ So Do |
```

##### 《青花瓷》主旋律片段
```
Do Re Mi So | La So Mi Re | Do _ _ _ |
Mi Fa So La | Do(高) Si La So | Fa Mi Re Do |
```

### 编译和下载
1. 使用Quartus Prime打开项目文件 `Electric_Piano.qpf`
2. 编译项目：Analysis & Synthesis → Fitter → Assembler
3. 将生成的.sof文件下载到FPGA开发板
4. 享受音乐演奏的乐趣！

### 扩展功能建议
1. 添加更多歌曲
2. 支持音量调节
3. 添加录音回放功能
4. 增加MIDI接口支持
5. 添加LCD显示歌词

### 注意事项
- 确保系统时钟频率为12MHz
- 蜂鸣器连接需要适当的驱动电路
- LED显示需要限流电阻
- 建议在安静环境下测试音频效果

### 版本信息
- 版本: V2.0
- 作者: GitHub Copilot
- 日期: 2025年5月26日
- 基于: Step FPGA示例代码扩展开发

### 致谢
感谢周杰伦先生创作的优美音乐作品，为本项目提供了丰富的音乐素材。
